

	<!doctype html>
	<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<title>
			Software Application Layers And Responsibilities
		</title>

		
		<meta name="Keywords" content="coldfusion,software architecture,business logic,domain model,domain service,mvc,oop,services,gateways" />
		<meta name="Description" content="Ben Nadel starts to codify his thoughts about software application layers and responsibilities. This includes the Controller, Application, Domain, and Infrastructure layers." />
		<link rel="shortcut icon" type="image/ico" href="/favicon.png"></link>

		
		<link rel="alternate" type="application/rss+xml" title="Ben Nadel's ColdFusion, JavaScript, User Experience (UX), and Web Development RSS" href="/index.cfm?event=blog.rss"></link>
		
		
		<link href="https://plus.google.com/108976367067760160494?rel=author" rel="publisher" />

		
		<meta name="verify-v1" content="4BMHbbVgHMewa8Orm/PNkp0/RtWXuI4Fh/IKPkE2y7A=" />
		<meta name="google-site-verification" content="vR-ZlPTSF4uAlM0vCQPsoVsVSwslsq0tSftkSrGGQ-w" />

		
		<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,400,700,900|Open+Sans:300,400,600,700,400italic,300italic"></link>
		<link rel="stylesheet" type="text/css" href="/linked/css/bennadel.css?v=2015-05-15"></link>

		
		

			
			<meta name="twitter:card" content="summary" />
			<meta name="twitter:site" content="@BenNadel" />
			<meta name="twitter:title" content="Software Application Layers And Responsibilities" />
			<meta name="twitter:description" content="Ben Nadel starts to codify his thoughts about software application layers and responsibilities. This includes the Controller, Application, Domain, and Infrastructure layers." />

			
	</head>
	<body id="body">

		
		<header class="l-site-header">

			<div class="masthead">

				<a href="/index.cfm" title="Ben Nadel on User Experience (UX), JavaScript, ColdFusion, Node.js, Life, and Love." class="title">
					Ben Nadel
				</a>

				<div class="tagline">
					On User Experience (UX) Design, JavaScript, ColdFusion, Node.js, Life, and Love.
				</div>

			</div>

			<nav class="active-blog">

				<a href="#primary-navigation" class="root">
					Navigation:
				</a>

				<ul id="primary-navigation" class="items">
					<li class="blog">
						<a href="/blog/recent-blog-entries.htm" title="Ben Nadel's Blog On Obsessively Thorough Web Application Development.">Home</a>
					</li><!--
					--><li class="projects">
						<a href="/projects/overview.htm" title="Ben Nadel's open source web development projects.">Projects</a>
					</li><!--
					--><li class="about">
						<a href="/about/about-ben-nadel.htm" title="Learn more about Ben Nadel, Co-founder of InVision App, Inc.">About Me</a>
					</li><li class="contact">
						<a href="/contact/contact-ben-nadel.htm" title="Contact Ben Nadel for any web development consutling.">Contact</a>
					</li><!--
					--><li class="jobs">
						<a href="/jobs/web-development-jobs.htm" title="Find your next web development job on Ben Nadel's job board.">Jobs ( 3 )</a>
					</li><!--
					--><li class="people">
						<a href="/people/who-rock-my-world.htm" title="The amazing people who rock Ben Nadel's world on the daily!">People</a>
					</li><!--
					--><li class="rss">
						<a href="/index.cfm?event=blog.rss" title="The BenNadel.com RSS feed." class="rss">RSS</a>
					</li>
				</ul>

			</nav>

			<figure>

				<img src="/images/header/photos/invision_dinner.jpg" data-rel="612" alt="Ben Nadel at cf.Objective() 2014 (Bloomington, MN) with: Joel Hill and Matt Vickers and Shawn Grigson and Jonathan Rowny and Jonathan Dowdle and Christian Ready and Oscar Arevalo and Jeff McDowell and Steve 'Cutter' Blades" />

				<figcaption>

					Ben Nadel at cf.Objective() 2014 (Bloomington, MN) with: 
							<span class="person"><a href="https://www.linkedin.com/profile/view?id=26845321" target="_blank">Joel Hill</a> (&nbsp;<a href="https://twitter.com/Jiggidyuo" target="_blank">@Jiggidyuo</a>&nbsp;)</span>
						
							,
						
							<span class="person"><a href="http://facetdev.com/" target="_blank">Matt Vickers</a> (&nbsp;<a href="https://twitter.com/envex" target="_blank">@envex</a>&nbsp;)</span>
						
							,
						
							<span class="person"><a href="https://www.linkedin.com/pub/shawn-grigson/0/767/8bb" target="_blank">Shawn Grigson</a> (&nbsp;<a href="https://twitter.com/shawngrig" target="_blank">@shawngrig</a>&nbsp;)</span>
						
							,
						
							<span class="person"><a href="http://www.jonathanrowny.com/" target="_blank">Jonathan Rowny</a> (&nbsp;<a href="https://twitter.com/jrowny" target="_blank">@jrowny</a>&nbsp;)</span>
						
							,
						
							<span class="person"><a href="http://jondowdle.com/" target="_blank">Jonathan Dowdle</a> (&nbsp;<a href="https://twitter.com/jdowdle" target="_blank">@jdowdle</a>&nbsp;)</span>
						
							,
						
							<span class="person"><a href="http://christianready.com" target="_blank">Christian Ready</a> (&nbsp;<a href="https://twitter.com/christianready" target="_blank">@christianready</a>&nbsp;)</span>
						
							,
						
							<span class="person"><a href="http://www.oscararevalo.com/blog/" target="_blank">Oscar Arevalo</a> (&nbsp;<a href="https://twitter.com/oarevalo" target="_blank">@oarevalo</a>&nbsp;)</span>
						
							,
						
							<span class="person"><a href="https://www.linkedin.com/profile/view?id=1366382" target="_blank">Jeff McDowell</a> (&nbsp;<a href="https://twitter.com/jeff_s_mcdowell" target="_blank">@jeff_s_mcdowell</a>&nbsp;)</span>
						
							,
						
							and
						
							<span class="person"><a href="http://blog.cutterscrossing.com/" target="_blank">Steve 'Cutter' Blades</a> (&nbsp;<a href="https://twitter.com/cutterbl" target="_blank">@cutterbl</a>&nbsp;)</span>
						

				</figcaption>

			</figure>

		</header>
		


		
		<div id="site-content" class="l-site-body">

			
			<div class="l-site-content content">

				

		<article 
			id="blog-post" 
			data-id="2437" 
			data-gist-id="">

			<header class="m-post-header">

				<h1>
					Software Application Layers And Responsibilities
				</h1>

				<div class="meta">
					By <a href="https://plus.google.com/108976367067760160494?rel=author" title="Author: Ben Nadel on Google+" class="author">Ben Nadel</a>
					on
					<time datetime="2012-12-21">December 21, 2012</time>
				</div>

				
				
					
					<div class="tags">
						Tags:

						
							<a href="/blog/tags/1-coldfusion-blog-entries.htm" class="tag">ColdFusion</a> 
					</div>

				

			</header>


			<p>I know that I haven't done much blogging lately (due to work); but, I've been doing a ton of thinking about software application architecture. Much of this thought has been influenced by previos projects as well as the pain and subsequent refactoring of my current project. On top of that, the people who comment on this blog have been extremely influential in shaping the way that I am coming to understand application architecture. That said, as we close out 2012, I wanted to take a few minutes to outline my current feelings about how I see the application layers and what their respective responsibilities are.</p><p>Right now, I am thinking in terms of building software with the following layers:</p><ul><li>Controller Layer</li><li>Application Layer</li><li>Domain Layer</li><li>Infrastructure Layer</li></ul><p>Before I get into the details of each layer, let me make some broad sweeping philosophical statements:</p><ul class="paragraphspacing"><li>Each of the above layers depends exclusively on the layer immediately below it. </li><li>Outside of entities (ex. Linked Lists), circular references are to be avoided. The more I think about it, the more I tend to feel that circular references are a sign that I am missing orchestration at a higher level of the application. </li></ul><p>That said, let's look at each layer. Because I am still forming all of these thoughts in my head, I'm going to write mostly in bullet-points. I don't think my understanding is refined enough to write technical prose.</p><h3>Controller Layer</h3><ul class="paragraphspacing"><li>It is the public face of the application. </li><li>It routes incoming requests and returns responses.</li><li>Both incoming and outgoing data is restricted to simple data types (ex. structs, arrays, numbers, strings, etc.). This could be JSON, HTML, XML, binary, AMF, etc..</li><li>It performs high-level security and authentication. Since different requests may be using different forms of identification (ex. cookies, HTTP Basic Authentication, oAuth, SAML), it is the Controller's responsibility to orchestrate the transformation of request data into authentication data.</li><li>The Controller layer may invoke the application layer to help with authentication. However, if requirements are simple enough (ex. Basic Authentication for 3rd-party Web Hooks), the controller layer may perform its own authentication.</li><li>It is the only part of the entire application that knows about session management.</li><li>It is very thin, using the Application layer to perform most of the work.</li></ul><h3>Application Layer</h3><ul class="paragraphspacing"><li>It is the programmatic boundary of the application.</li><li>It accepts and returns simple data structures. However, unlike the Controller layer, it probably shouldn't deal with data like JSON or HTML. Rather, it deals with non-serialized data structures and relies on the Controller to serialize and deserialize data representations.</li><li>It performs low-level security and checks access permissions. In the case of a request made by a user, the application would be responsible for checking whether or not the requesting user has the right to perform the given action (ex. can this User delete that Publication).</li><li>All methods in the application layer that can be invoked by a user's request should require the authenticated user ID as the first argument.</li><li>It orchestrates Transactions management. </li><li>It orchestrates workflow, but defers to the Domain Layer to carry out each step of the workflow. </li><li>It is moderately thin and defers to the domain layer for the bulk of its logic. </li></ul><h3>Domain Layer</h3><ul class="paragraphspacing"><li>It contains the "business logic" of the application. </li><li>It maintains data integrity. </li></ul><p><em><strong>NOTE</strong>: Since I don't currently deal with "domain entities," my thoughts on the domain layer are, by far, the least evolved. I typically deal with domain services and raw data structures.</em></p><h3>Infrastructure Layer</h3><ul class="paragraphspacing"><li>It provides adaptors for technologies such as persistence, file systems, email, Twitter, Twilio, Pusher, etc.. </li><li>It deals with simple data structures (ex. structs, arrays, numbers, strings, binary, etc.).</li></ul><p>So, right now, as of Dec 21, 2012 at 5:05 PM, this is how I see application architecture. I am hyper-specific about the time since my understanding and thoughts about software application architecture are constantly evolving. I've come a long way in 2012 (I think); I hope that 2013 brings new levels of enlightenment and understanding!</p> 

				<div class="m-tweet-this">
					
					<a 
						href="https://twitter.com/intent/tweet?text=Fascinating%20post%20by%20%40BenNadel%20%2D%20Software%20Application%20Layers%20And%20Responsibilities%20http%3A%2F%2Fbjam%2Ein%2F2437" 
						target="tweetThis2437"
						onclick="window.open( this.href, 'tweetThis2437', 'width=600,height=425' ).focus()">
						<span class="label">Tweet This</span>
						<span class="message">Fascinating post by @BenNadel - Software Application Layers And Responsibilities</span>
					</a>

					<span class="thanks">Thanks my man &mdash; <strong>you rock the party that rocks the body!</strong></span>
					
				</div>
				
			

				<div class="hrule">
					<br />
				</div>


				<!-- BEGIN: Related Posts. -->
				<aside class="m-related-posts">

					<h3>
						Enjoyed This? You Might Also Enjoy Reading:
					</h3>

					<ul
						style="overflow: auto ; height: 120px ;"
						>
						
						
							<li>
								<a href="/blog/2470-what-if-all-user-interface-ui-data-came-in-reports.htm">What If All User Interface (UI) Data Came In Reports?</a>
							</li>
						
							<li>
								<a href="/blog/2466-stateless-service-singletons-vs-stateful-service-entities.htm">Stateless Service Singletons vs. Stateful Service Entities</a>
							</li>
						
							<li>
								<a href="/blog/2454-exploring-sample-software-application-layers-and-responsibilities.htm">Exploring Sample Software Application Layers And Responsibilities</a>
							</li>
						
							<li>
								<a href="/blog/2438-command-query-responsibility-segregation-cqrs-makes-domain-models-practical.htm">Command-Query-Responsibility-Segregation (CQRS) Makes Domain Models Practical</a>
							</li>
						
							<li>
								<a href="/blog/2436-what-the-heck-is-business-logic-anyway.htm">What The Heck Is Business Logic Anyway?</a>
							</li>
						
							<li>
								<a href="/blog/2385-application-services-vs-infrastructure-services-vs-domain-services.htm">Application Services vs. Infrastructure Services vs. Domain Services</a>
							</li>
						
							<li>
								<a href="/blog/2384-more-thinking-about-model-view-controller-mvc-and-application-architecture.htm">More Thinking About Model-View-Controller (MVC) And Application Architecture</a>
							</li>
						
							<li>
								<a href="/blog/2379-a-better-understanding-of-mvc-model-view-controller-thanks-to-steven-neiland.htm">A Better Understanding Of MVC (Model-View-Controller) Thanks To Steven Neiland</a>
							</li>
						

					</ul>

				</aside>
				<!-- END: Related Posts. -->

			


			<div class="hrule">
				<br />
			</div>


			<!-- BEGIN: Job Listings. -->
			<div class="m-recent-jobs">

				<h3>
					Looking For A <em>New Job</em>?
				</h3>

				<div class="actions">
					<a href="/jobs/web-development-jobs.htm" title="Find your next web development job on Ben Nadel's job board.">View All Jobs</a> 
					&nbsp;|&nbsp;
					<a href="/jobs/post-a-job-listing.htm" title="Post a job now! Only $29!">Post A Job - Only $29</a> &raquo;
				</div>

				
				

					<ul>
						

							<li>
								<a 
									href="/jobs/394-Developer.htm" 
									title="Your new job: Developer">
									<span class="title">Developer</span> <span class="company">at AuSuM Systems</span>
								</a>
							</li>

						

							<li>
								<a 
									href="/jobs/393-ColdFusion-Developer.htm" 
									title="Your new job: ColdFusion Developer">
									<span class="title">ColdFusion Developer</span> <span class="company">at Dominion Enterprises</span>
								</a>
							</li>

						

							<li>
								<a 
									href="/jobs/392-ColdFusion-Developer.htm" 
									title="Your new job: ColdFusion Developer">
									<span class="title">ColdFusion Developer</span> <span class="company">at Cavulus</span>
								</a>
							</li>

						
					</ul>	
				
				
				

				<div class="kiva">
					100% of job board revenue is donated to Kiva. <em>Loans that change lives</em> &mdash; <a href="/jobs/web-development-jobs.htm#kiva">Find out more</a> &raquo;
				</div>

			</div>
			<!-- END: Job Listings. -->

			
			<div class="hrule">
				<br />
			</div>


			<!-- BEGIN: Comments. -->
			<section class="m-comments">

				<h2>
					Reader Comments
				</h2>

				
				
				


					<!-- BEGIN: Comment. -->
					<article id="comments_41273" class="comment ">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/1233d4055106063cd48a2bbc9d630f74?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/10521-xdhmoore.htm" class="author">xdhmoore</a>

							<a href="#comments_41273" class="date">
								<time datetime="2012-12-21">Dec 21, 2012 at 7:50 PM</time>
							</a>

							<div class="count">
								1 Comments
							</div>

						</div>

						<div class="content">

							<p>This reminds me of our senior CSI project.  We had a REST API that was a thin layer on top of a single facade.  That way we could have implemented a SOAP API as well. External things like web services and database calls were abstracted out into Java interfaces.  This was nice when we had to replace one of the 3rd-party web services with a different one and when we needed to mock up a web service for load testing.  Our project was fairly simple compared to some real-world applications, but it was nice to have everything organized, and all layers making calls only &quot;downward&quot; in the stack.</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41274" class="comment ">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/0c40416e28deaeca133d8a0cc3a7e1bc?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/10019-dave-leeds.htm" class="author">Dave Leeds</a>

							<a href="#comments_41274" class="date">
								<time datetime="2012-12-21">Dec 21, 2012 at 8:18 PM</time>
							</a>

							<div class="count">
								4 Comments
							</div>

						</div>

						<div class="content">

							<p>Ben, great work! This is an excellent summary, and I think this architecture should work well for many applications.</p><p>As you noted, security can be a bit of a cross-cutting concern, depending in part on the granularity of permissions that are required. </p><p>You might not need to make it a universal rule to require each user-invoked method to specify the user ID as the first argument.  Depending on the particular use case, there could possibly be some operations that wouldn't actually make use of it.  But if that's what you end up with on your app, that's cool.</p><p>Again, great summary!</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41275" class="comment ">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/d5b74cdc57b94fb2d0caa6d8dc1d289b?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/949-kerr.htm" class="author">Kerr</a>

							<a href="#comments_41275" class="date">
								<time datetime="2012-12-21">Dec 21, 2012 at 8:42 PM</time>
							</a>

							<div class="count">
								19 Comments
							</div>

						</div>

						<div class="content">

							<p>I always enjoy reading your thoughts, Ben.  You're eager to challenge your current thinking, which I find a bit rarer than I'd like.  I really am with you on having a thin Controller layer, and view it as more of a traffic cop role than anything else.</p><p>Regarding dependencies, I have found that to be a longer learning curve for me than in other areas.  I started seeing some light at the end of the tunnel when I began using dependency injection (DI).  Perhaps you've already explored all this stuf, but... In ColdFusion, DI/1, the sister to FW/1, is a great example of how this can be done cleanly and without much fuss.  The ColdBox project also has a very full featured dependency injection framework.  You'll find that the two projects come from different mindsets.  I like them both, depending on the project.  One thing you will need to consider with ColdBox, though, is a relatively steep learning curve.</p><p>Another thing that accelerated my view of (web) application architecture was exploring various frameworks in various languages.  Building non-trivial applications in a variety of frameworks gets you well informed and you'll see the same patterns approached with different points of view.</p><p>When dealing with frameworks in general, I've encountered two main groups of people: Adherents to micro frameworks that provide a bare implementation of some design pattern(s), and full-stack fans who prefer the kitchen sink approach.  I kind of sit in the middle, since I've come across both styles that I either enjoyed or didn't, for myriad reasons.  If you're working in the ColdFusion space, I think one is well served exploring either / both FW/1 and ColdBox.</p><p>Anyway, back on point.  Again, I really encourage a look at DI and how it can help you solve those cross cutting concerns.  For instance, your security layer could be something that is injected where needed, and depending on environment tweaked so that the context sensitive security checks you mentioned are done, or perhaps user emulation is possible on a certain environment but not another.  Logging is another classic cross cutting concern that DI solves with aplomb.  For example, log verbosely in development, but not production, depending on log level, etc.</p><p>I could be wasting my fingers though... you may be coming at this from a JavaScript oriented view!</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41276" class="comment ">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/d5b74cdc57b94fb2d0caa6d8dc1d289b?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/949-kerr.htm" class="author">Kerr</a>

							<a href="#comments_41276" class="date">
								<time datetime="2012-12-21">Dec 21, 2012 at 8:47 PM</time>
							</a>

							<div class="count">
								19 Comments
							</div>

						</div>

						<div class="content">

							<p>Oh, the other thing I think that bears mention from a dependency perspective is this:  Strongly consider how coupled your service / data persistence layer is to anything else.  Ideally, it should be able to be propped up, tested, and survive on its own accord without anything else touching it.  Certain ORM implementations will lead you down a dark, shadowy path of inbuilt framework dependency.</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41282" class="comment ben">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/f9bbc701ca6770ef482cc1e172344e25?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1851-ben-nadel.htm" class="author">Ben Nadel</a>

							<a href="#comments_41282" class="date">
								<time datetime="2012-12-23">Dec 23, 2012 at 11:13 AM</time>
							</a>

							<div class="count">
								13,029 Comments
							</div>

						</div>

						<div class="content">

							<p>@Xdhmoore, </p><p>I recently had to rewrite an API that used to live as a parallel site that connected to a database. When I built the site originally, it took me like 3 weeks to put the API site together, duplicating all of the business logic from the main site. </p><p>Then, going back and gutting the API and connecting in the domain layer that was used by the main site, I got the API site up and running in a single day. That was a pretty amazing moment for me - it really drove home how powerful it is to have a well bounded application core that multiple sites can hook into. </p><p>I'm sure, even with that instance, I'm not dong a great job of it (I have some odd sharing of components); but, even there, it's clear to see how powerful a good, layered architecture can be.</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41283" class="comment ben">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/f9bbc701ca6770ef482cc1e172344e25?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1851-ben-nadel.htm" class="author">Ben Nadel</a>

							<a href="#comments_41283" class="date">
								<time datetime="2012-12-23">Dec 23, 2012 at 11:17 AM</time>
							</a>

							<div class="count">
								13,029 Comments
							</div>

						</div>

						<div class="content">

							<p>@Dave, </p><p>My current app makes heavy use of user-based permissions for all kinds of actions within the application logic. Some users can perform XYZ, but only the owner of a particular entity can perform action ABC (and things like that). Then, it depends on the type of subscription a given user has (and if that user is an &quot;owner&quot; or simply a &quot;member&quot;). </p><p>That said, in hindsight (given what you said), I can see that that is very tightly coupled to my application's requirements. If I had an app that was limited to logged-in/logged-out requirements, I wouldn't see any need to pass the userID around.</p><p>That said  - I love that turn of phrase too much :) - if you *did* pass in the userID to user-based methods, it would allow the application logic to evolve (ex. adding user logging or request limits) without the Controller having to change too much. Of course, you don't necessarily want to plan for problems you don't have yet.</p><p>So, all to say, I agree with what you're saying.</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41284" class="comment ">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/b90eced263180279da61ffbcef1b0a76?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/9933-topper.htm" class="author">Topper</a>

							<a href="#comments_41284" class="date">
								<time datetime="2012-12-23">Dec 23, 2012 at 11:59 AM</time>
							</a>

							<div class="count">
								4 Comments
							</div>

						</div>

						<div class="content">

							<p>Interesting read Ben,</p><p>I can draw similarities to the structure we have in TeamworkPM; we have:</p><p>Main app = controller<br />Api = controller<br />Twcore = all business logic = application/domain<br />Util = infrastructure</p><p>We also have TwData = shared memcached query lookups</p><p>Thanks for the food for thought as always. Have a great Xmas.</p><p>Peter</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41286" class="comment ben">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/f9bbc701ca6770ef482cc1e172344e25?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1851-ben-nadel.htm" class="author">Ben Nadel</a>

							<a href="#comments_41286" class="date">
								<time datetime="2012-12-24">Dec 24, 2012 at 8:59 AM</time>
							</a>

							<div class="count">
								13,029 Comments
							</div>

						</div>

						<div class="content">

							<p>@Kerr, </p><p>I've recently started using DI/1 as my first &quot;official&quot; dependency injection framework. Up until now, I've bootstrapped my application my explicitly instantiating (and caching) my ColdFusion component with constructor arguments. So, basically doing this:</p><div class="code"><ul><li>application.objA = new com.ObjectA();</li><li>application.objB = new com.ObjectB( application.objA );</li></ul></div><p>And, since I never had many components, this was actually fairly easy and let to a great deal of flexibility in how I created and cached components. Furthermore, I never really felt the &quot;pain&quot; that so many people talk about when it comes to organizing their components (I think people exaggerate pain in coding).</p><p>That said, I have really come to enjoy the way I can simply add &quot;property&quot; tags to the top of my components and they just work. Of course, this enjoyment is disrupted when I have a component that requires some constructor arg like &quot;username&quot; or &quot;apiKey&quot; and suddenly I have to jump through a bunch of hoops to get that working in a DI framework.</p><p>So, for me, it's nice, but it seems like 6 of one, half a dozen of the other. </p><p>As far as the dependency of the Model on the Database, it currently goes through a Data Gateway [set of] components. I don't really deal with &quot;domain entities&quot; currently; my model layer is really more of a collection of domain services than anything else. I'm hoping to learn more about entities and how they behave in a good architecture.</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41287" class="comment ben">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/f9bbc701ca6770ef482cc1e172344e25?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1851-ben-nadel.htm" class="author">Ben Nadel</a>

							<a href="#comments_41287" class="date">
								<time datetime="2012-12-24">Dec 24, 2012 at 9:01 AM</time>
							</a>

							<div class="count">
								13,029 Comments
							</div>

						</div>

						<div class="content">

							<p>@Topper, </p><p>Definitely sound very similar. The shared caching layer sound very interesting also!</p><p>Have a wonderful Christmas and New Yar!</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41288" class="comment ">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/d5b74cdc57b94fb2d0caa6d8dc1d289b?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/949-kerr.htm" class="author">Kerr</a>

							<a href="#comments_41288" class="date">
								<time datetime="2012-12-24">Dec 24, 2012 at 9:39 AM</time>
							</a>

							<div class="count">
								19 Comments
							</div>

						</div>

						<div class="content">

							<p>@Ben,</p><p>That's great you're using DI/1.  I imagine you've come across the injectProperties factory method for dealing with bean arguments.  It can be interesting making sure that argument names don't conflict when you do lots of setter injection though.  Still, not being married to com.x.y.z or some other pre-ordained directory structure is a big payoff for me.  One could do dynamic mappings, but that IMO is a very slightly different solution.</p><p>I guess I'd rather deal with the argument side effects than physical directory issues.  Plus, if you need to alter contextual behavior (pass in an entirely different object), that is a snap with DI.  My experience is that it's been cumbersome without it.</p><p>As far as model dependencies go, I was writing from a framework&lt;-&gt;model dependency point of view.  There are full stack frameworks that require you to fire up the framework itself just to get at your services.  If you're not there, and it sounds like you're not, it's all gravy!</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41298" class="comment ben">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/f9bbc701ca6770ef482cc1e172344e25?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1851-ben-nadel.htm" class="author">Ben Nadel</a>

							<a href="#comments_41298" class="date">
								<time datetime="2012-12-28">Dec 28, 2012 at 4:35 PM</time>
							</a>

							<div class="count">
								13,029 Comments
							</div>

						</div>

						<div class="content">

							<p>@Kerr, </p><p>This is my first project with DI/1, so I'm not fully familiar with the various methods. For things that are more 3rd-party components (like a Twilio / Twitter gateway), I'll typically just instantiate it with the various API keys that it needs and then just stuff it into the beanFactory as a constant or named-bean. </p><p>3rd-party stuff, however, is the minority of our uses-cases in the app, so mostly, we get to just wire stuff up simply with &quot;property&quot; tags.</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41307" class="comment ">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/bab3d6eac3bdc2e530db285f993b1f0d?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1210-murray-hopkins.htm" class="author">Murray Hopkins</a>

							<a href="#comments_41307" class="date">
								<time datetime="2012-12-29">Dec 29, 2012 at 5:49 PM</time>
							</a>

							<div class="count">
								37 Comments
							</div>

						</div>

						<div class="content">

							<p>Thanks Ben. Your architecture is very similar to what I ended up with. I ended up building my own framework in order to learn about these issues. However, I do use Taffy for my REST controller (just to parse and return the web request). </p><p>user web request --&gt; Taffy(REST request parsing) --&gt; Security (injection detection, user authentication) --&gt;  Controller --&gt; ClientFormatting (for return only) --&gt; Application --&gt; Domain.</p><p>The reason for the ClientFormatting layer is that I typically use 100% JS for the client side (typically ExtJS / Sench Touch) and CF for the server side. Now, ExtJS has components like forms, grids, trees etc and can consume json, XML, etc. However, since a form requires a single &quot;object&quot; while a grid is an array of objects and a tree is nested data the construction of the (say) json will differ depending upon what component is asking for the data. And, metadata required by the component (eg recordcounts for grids, validation data from the server side for forms, etc) also has a required format / layout that depends upon the component asking for the data.</p><p>Now, given that a server side &quot;entity&quot; may potentially have it's data represented on the client side as a form, grid or tree, but it should not know that, my ClientFormatting layer takes the CF data structure returned from the Application layer and rearranges it to produce the kind of json layout and metadata that the specific component needs. The client web request contains a parameter like (forForm, forGrid, forTree) and the ClientFormatting layer is the only layer that uses those parameters.</p><p>I set it up so that the ClientFormatting can also handle other server side languages as &quot;plugins&quot;. So the server side then effectively &quot;speaks&quot; Ext json for a form, or Ext XML for a tree, or {your server side library} for {your choice of data format} for {your choice of client side component}. So, the ClientFormatting layer is all that needs to change if I start using a new client side library, or if I want the same server app to provide data as a published &quot;API&quot; with different data types (json, xml, etc). </p><p>While I havent done it yet, I intend to add RPC capability at some stage too.</p><p>So, to sum up, the server can then &quot;speak&quot; multiple languages and &quot;dialects&quot; without touching the Controller or Application layers. The REST request determines what action to take and what data is requested (via the Controller), while the ClientFormatting layer controls the format of the data being passed back to the Controller depending upon &quot;who&quot; the client side library is.</p><p>Thanks for the discussion,<br />Murray</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41366" class="comment ben">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/f9bbc701ca6770ef482cc1e172344e25?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1851-ben-nadel.htm" class="author">Ben Nadel</a>

							<a href="#comments_41366" class="date">
								<time datetime="2013-01-04">Jan 4, 2013 at 9:15 PM</time>
							</a>

							<div class="count">
								13,029 Comments
							</div>

						</div>

						<div class="content">

							<p>@Murray, </p><p>Formatting the response for the client is definitely something that I am &quot;hacking&quot; right now. We jump through a number of hoops to strip out unsafe data (ex. passwords, secret keys) and making sure the case of keys translates well from ColdFusion (non-case sensitive) to JavaScript (case sensitive) and that data types make sense (ex. converting CF date/time stamps to client-side UTC milliseconds). </p><p>All to say, that's one of the weakest parts of my app. But, part of that is based on the shoe-horning of a single model into both the Command AND Query aspects of the application (as you know from our other discussion). </p><p>Uggg, so much research to do... no enough time!</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41375" class="comment ">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/d3a08abca59684b36ac5c73496a7662a?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/10556-eric.htm" class="author">Eric</a>

							<a href="#comments_41375" class="date">
								<time datetime="2013-01-06">Jan 6, 2013 at 9:14 AM</time>
							</a>

							<div class="count">
								3 Comments
							</div>

						</div>

						<div class="content">

							<p>Often my controller layer manages transaction boundaries, so I think transaction management is the responsibility of both the controller and application layers.</p><p>I tend to keep my domain layer fairly light. My domain classes have methods relevant to those, but functionality that requires coordinating multiple entities usually ends up in my application layer.</p><p>Many of my choices are influenced by how course-grained or fine-grained I want my application layer API to be. I often avoid adding course-grained methods to the application layer by allowing the controller layer to manage transactions across multiple calls to the application layer.</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41454" class="comment ben">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/f9bbc701ca6770ef482cc1e172344e25?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1851-ben-nadel.htm" class="author">Ben Nadel</a>

							<a href="#comments_41454" class="date">
								<time datetime="2013-01-11">Jan 11, 2013 at 8:43 PM</time>
							</a>

							<div class="count">
								13,029 Comments
							</div>

						</div>

						<div class="content">

							<p>@Eric, </p><p>To be completely philosophical for a second, one thing I don't like about putting my transaction in the Controller layer is that it requires the controller to know about the type of storage that is being used. If you keep the transaction control in the Application layer, then all the Controller has to know about is the data that can go into and come out of the application - it doesn't know anything else. </p><p>That said, to get off my philosophical soap box :) in 12 years of web development, I've only ever changed my data storage layer twice.</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					<!-- BEGIN: Comment. -->
					<article id="comments_41766" class="comment ben">

						<div class="meta">

							<img src="https://www.gravatar.com/avatar/f9bbc701ca6770ef482cc1e172344e25?s=120&d=https%3A%2F%2Fwww%2Ebennadel%2Ecom%2Fimages%2Fgravatar%2Farnold%2Ejpg" class="avatar" />

							<a href="/members/1851-ben-nadel.htm" class="author">Ben Nadel</a>

							<a href="#comments_41766" class="date">
								<time datetime="2013-02-22">Feb 22, 2013 at 10:07 AM</time>
							</a>

							<div class="count">
								13,029 Comments
							</div>

						</div>

						<div class="content">

							<p>I tried to continue this thought experiment with a specific use-case in mind. I've found myself getting a bit lost and concerned with &quot;necessary&quot; duplication of effort.</p><p><a href="/blog/2454-Exploring-Sample-Software-Application-Layers-And-Responsibilities.htm" rel="nofollow" target="_blank">www.bennadel.com/blog/2454-Exploring-Sample-Software-Application-Layers-And-Responsibilities.htm</a></p><p>It's just some pseudo code. I'd love any feedback that people might have. Thanks!!!</p>

						</div>

						

					</article>
					<!-- END: Comment. -->

				


					
					<div class="comments-disabled">

						<div class="reason">
							<span>Oh my chickens, this post is old!</span>
						</div>

						<div class="follow-up">
							<a href="https://twitter.com/BenNadel" title="Ben Nadel's Twitter Account">
								<em>Hit me up on Twitter</em> if you want to discuss it further.
							</a>
						</div>

					</div>
					


				
				


			</section>
			<!-- END: Comments. -->

		</article>


		
		
		
	

			</div>
			


			
			<div class="l-site-aside">

				
				

					
					<div class="m-ad-cluster">

						<a href="/blog/2439-My-Experience-With-AngularJS-The-Super-heroic-JavaScript-MVW-Framework.htm" title="My Experience With AngularJS - The Super-heroic JavaScript MVW Framework" class="nw">
							My Experience With AngularJS - The Super Heroic JavaScript MVW Framework
						</a>
						
						<a href="/jobs/web-development-jobs.htm" title="Find your next web development job on the BenNadel.com job board." class="ne">
							Find your next web development job on the BenNadel.com job board
						</a>
						
						<a href="/blog/2192-One-Man-s-Search-For-Love-My-cf-Objective-2011-Lightning-Talk.htm" title="One Man's Search for Love, by Ben Nadel" class="sw">
							One Man's Search for Love - Lightning Talk
						</a>
						
						<a href="https://github.com/BenNadel" title="Ben Nadel's open-source development projects on GitHub." class="se">
							Fork Me on GitHub.com
						</a>

					</div>	
					


					
					<div class="m-invision-ad">

						<a 
							href="https://www.invisionapp.com?source=bennadel.com&amp;ad=large"
							title="UX Prototyping Made Beautiful - Create Interactive Wireframes &amp; High Fidelity Prototypes">
							UX Prototyping Made Beautiful - Create Interactive Wireframes &amp; High Fidelity Prototypes
						</a>

					</div>
					

				
				

			</div>
			


			
			<br clear="both" />

		</div>
		

		
		
		<footer class="l-site-footer">

			<small>

				<span class="copyright">
					Ben Nadel &copy; 2017. All content is the property of Ben Nadel and BenNadel.com.
				</span>

				<a href="#body" class="back-to-top">
					Back to Top
				</a>

			</small>

			<section class="epilogue">

				<div class="mini-resume">

					<div class="avatar">
						<img src="/images/global/ben-nadel-avatar.jpg" title="Ben Nadel is co-founder of InVision App, Inc. and a passionate web-applications developer." alt="Ben Nadel's avatar." />
					</div>

					<div class="title">
						About Ben Nadel
					</div>
					
					<div class="bio">
						I am the co-founder and lead engineer at InVision App, Inc &mdash; the world's leading prototyping, 
						collaboration &amp; workflow platform. I also rock out in JavaScript and ColdFusion 24x7 and I dream about
						promise resolving asynchronously. 
					</div>

					<div class="social-media">
						<a href="https://github.com/BenNadel" title="Follow Ben Nadel on GitHub.">GitHub</a> &nbsp;|&nbsp;
						<a href="https://www.twitter.com/BenNadel" title="Follow Ben Nadel on Twitter.">Twitter</a> &nbsp;|&nbsp;
						<a href="https://www.linkedin.com/in/BenNadel" title="Follow Ben Nadel on LinkedIn.">LinkedIn</a> &nbsp;|&nbsp;
						<a href="https://plus.google.com/108976367067760160494?rel=author" title="Follow Ben Nadel on Google Plus.">Google+</a> &nbsp;|&nbsp;
						<a href="https://www.facebook.com/BenNadel" title="Follow Ben Nadel on Facebook.">Facebook</a>
					</div>

				</div>

			</section>

		</footer>


		
		<script type="text/javascript" src="/linked/vendor/jquery/jquery-2.1.0.min.js"></script>
		<script type="text/javascript" src="/linked/js/standard.js?v=2015-05-26"></script>

		
		

			<script type="text/javascript" src="/linked/js/jquery.gist.js"></script>
			
		

			<script type="text/javascript" src="/linked/js/blog.js?v=42815.0940278"></script>
			
		
		
			
			<script type="text/javascript">
				(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
				})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
				ga('create', 'UA-477521-1', 'auto');
				ga('send', 'pageview');
			</script>
			

		

	</body>
	</html>
	
